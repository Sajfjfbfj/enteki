<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- ===========================
     ファビコン・PWA設定
============================ -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#1969e1">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">

<title>MATOMA | 弓道道具管理ページ</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script>
  tailwind.config = {
    darkMode: "class",
    theme: {
      extend: {
        colors: {
          "primary": "#1969e1",
          "background-light": "#f6f7f8",
          "background-dark": "#111721"
        },
        fontFamily: {
          "display": ["Manrope", "Yu Gothic", "Hiragino Maru Gothic ProN", "sans-serif"]
        },
        borderRadius: {
          "DEFAULT": "0.5rem",
          "lg": "1rem",
          "xl": "1.5rem",
          "full": "9999px"
        }
      }
    }
  }
</script>

<!-- Google Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shepherd.js/dist/css/shepherd.css"/>

<style>
  body { padding-bottom: 80px; }
  .center-tab-button {
    position: relative;
    top: -20px;
    width: 64px;
    height: 64px;
    background: linear-gradient(135deg, #1969e1, #1557c7);
    border-radius: 50%;
    box-shadow: 0 8px 24px rgba(25, 105, 225, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
  }
  #message {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

/* カード全体 */
.tool-card {
  background: #fff;
  border-radius: 1rem;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  padding: 1rem 1.25rem;
  border: 1px solid rgba(0,0,0,0.05);
  transition: all 0.2s ease-in-out;
}
.tool-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(25, 105, 225, 0.15);
}

/* タイトル */
.tool-card h3 {
  font-weight: 700;
  color: #1969e1;
  font-size: 1rem;
  margin-bottom: 0.5rem;
}

/* 各道具行 */
.tool-card ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
.tool-card li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.35rem 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}
.tool-card li:last-child {
  border-bottom: none;
}

/* テキスト */
.tool-name {
  font-weight: 600;
  color: #1e293b;
}
.tool-feature {
  color: #64748b;
  font-size: 0.9rem;
}

/* ダークモード対応 */
.dark .tool-card {
  background: #1e293b;
  border-color: rgba(255, 255, 255, 0.1);
}
.dark .tool-card h3 {
  color: #60a5fa;
}
.dark .tool-name {
  color: #e2e8f0;
}
.dark .tool-feature {
  color: #94a3b8;
}

</style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200">
<div class="flex flex-col min-h-screen">

  <!-- ヘッダー -->
  <header class="sticky top-0 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm z-10 shadow-sm">
    <div class="flex items-center justify-between h-14">
  <h1 class="text-lg font-bold text-slate-900 dark:text-white">MATOMA遠的</h1>
  <div class="flex items-center gap-2">
    <!-- 共有ボタン -->
    <button id="shareBtn"
      class="px-4 py-2 bg-primary text-white rounded-full hover:bg-blue-600 text-sm font-semibold shadow-md transition-all">
      共有
    </button>

    <!-- 設定ボタン（歯車） -->
    <button id="settingsBtn"
      class="p-2 rounded-full bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-200 transition-all shadow-sm"
      title="設定ページ">
      <span class="material-symbols-outlined text-2xl">settings</span>
    </button>
  </div>
</div>

  </header>

  <!-- 「初めての方へ」ボタン -->
  <div class="hidden md:block fixed bottom-4 right-4 z-50">
    <button id="tutorialBtn" class="px-3 py-2 text-sm sm:text-base bg-primary text-white rounded-lg shadow-lg hover:bg-primary/80">
      初めての方へ
    </button>
  </div>
  <div class="md:hidden w-full py-2 bg-background-light dark:bg-background-dark shadow-sm">
    <div class="container mx-auto px-4 flex justify-center">
      <button id="tutorialBtnMobile" class="px-4 py-2 text-base bg-primary text-white rounded-lg shadow-lg hover:bg-primary/80">
        初めての方へ
      </button>
    </div>
  </div>

  <!-- メインコンテンツ -->
  <main class="flex-grow container mx-auto px-4 py-6 space-y-8">
    <h1 class="text-2xl font-bold mb-4 text-slate-900 dark:text-white">弓道道具管理ページ</h1>

    <!-- 登録メッセージ -->
    <p id="message" class="text-slate-600 dark:text-slate-400 mb-4"></p>

    <!-- 編集エリア -->
    <div id="editArea" class="mt-4 space-y-6 hidden"></div>

  </main>

  <!-- 下部タブバー -->
  <nav class="tab-bar fixed bottom-0 left-0 right-0 z-40 px-4 py-2 bg-background-light dark:bg-background-dark/95 backdrop-blur-md">
    <div class="max-w-2xl mx-auto flex items-end justify-around relative">
      <a href="tools.html" class="flex flex-col items-center gap-1 py-2 px-3 text-primary">
        <span class="material-symbols-outlined text-2xl">construction</span>
        <span class="text-xs font-semibold">道具</span>
      </a>

      <a href="index.html" class="flex flex-col items-center gap-1 py-2 px-3 text-slate-500 dark:text-slate-400 hover:text-primary transition-colors">
        <span class="material-symbols-outlined text-2xl">today</span>
        <span class="text-xs font-semibold">今日の記録</span>
      </a>

      <!-- 中央ボタン -->
      <button id="centerActionBtn" class="center-tab-button" aria-label="編集/保存" type="button">
        <span id="centerIcon" class="material-symbols-outlined icon-center">edit</span>
      </button>

      <a href="yadokoro.html" class="flex flex-col items-center gap-1 py-2 px-3 text-slate-500 dark:text-slate-400 hover:text-primary transition-colors">
        <span class="material-symbols-outlined text-2xl">analytics</span>
        <span class="text-xs font-semibold">分析</span>
      </a>
      <a href="help.html" class="flex flex-col items-center gap-1 py-2 px-3 text-slate-500 dark:text-slate-400 hover:text-primary transition-colors">
        <span class="material-symbols-outlined text-2xl">help</span>
        <span class="text-xs font-semibold">ヘルプ</span>
      </a>
    </div>
  </nav>

</div>

<!-- 保存メッセージオーバーレイ -->
<div id="messageOverlay" class="fixed inset-0 flex items-center justify-center pointer-events-none">
  <div class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-300"></div>
</div>

<!-- JS -->
<script src="js/tools.js"></script>
<script src="js/page.js"></script>
<script src="https://cdn.jsdelivr.net/npm/shepherd.js/dist/js/shepherd.min.js"></script>

<script>

// 初めての方へチュートリアル
function startTutorial() {
  const tour = new Shepherd.Tour({
    defaultStepOptions: {
      scrollTo: { behavior: 'smooth', block: 'center' }
    }
  });

  tour.addStep({
    text: 'このボタンで道具編集画面を開き、保存できます。',
    attachTo: { element: '#centerActionBtn', on: 'top' },
    buttons: [
      { text: '次へ', action: tour.next }
    ]
  });

  tour.addStep({
    text: 'ここから各ページに移動できます。',
    attachTo: { element: '.tab-bar', on: 'top' },
    buttons: [
      { text: '終了', action: tour.complete }
    ]
  });

  tour.start();
}

document.getElementById("tutorialBtn").addEventListener("click", startTutorial);
document.getElementById("tutorialBtnMobile").addEventListener("click", startTutorial);

// 共有ボタン
document.getElementById("shareBtn").addEventListener("click", async () => {
  const shareText = "MATOMA遠的の矢所分析で射の傾向をチェックしよう！";
  const shareUrl = window.location.href;
  if (navigator.share) {
    try { await navigator.share({ title: "MATOMA遠的", text: shareText, url: shareUrl }); }
    catch(err){ console.error(err); }
  } else {
    try { await navigator.clipboard.writeText(`${shareText} ${shareUrl}`); alert("リンクをコピーしました。"); }
    catch(err){ prompt("コピーできません。以下をコピーしてください:", `${shareText} ${shareUrl}`); }
  }
});

// Service Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/service-worker.js')
      .then(reg => console.log('Service Worker registered:', reg))
      .catch(err => console.error('Service Worker registration failed:', err));
  });
}
</script>
<script>
  // ======== ページ読込時にテーマを反映 ========
  (function() {
    const theme = localStorage.getItem("theme");
    if (theme === "dark") {
      document.documentElement.classList.add("dark");
    } else {
      document.documentElement.classList.remove("dark");
    }
  })();
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const settingsBtn = document.getElementById("settingsBtn");
  if (settingsBtn) {
    settingsBtn.addEventListener("click", () => {
      window.location.href = "settings.html"; // ← 設定ページへ遷移
    });
  }
});
</script>

</body>
</html>
